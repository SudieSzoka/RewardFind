<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>Excel查找工具</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.sheetjs.com/xlsx-0.18.5/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <script src="script.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container mt-4">
        <h2>Excel查找工具</h2>
        
        <div class="mb-3">
            <label class="form-label">文件夹路径：</label>
            <div class="input-group">
                <input type="text" class="form-control" id="folderPath" readonly>
                <button class="btn btn-secondary" onclick="selectFolder()">选择文件夹</button>
            </div>
        </div>
        
        <div class="mb-3">
            <label class="form-label">搜索内容：</label>
            <input type="text" class="form-control" id="searchTarget" placeholder="输入搜索内容">
        </div>
    
        <div class="mb-3">
            <label class="form-label">Excel文件名列表（用逗号分隔）：</label>
            <input type="text" class="form-control" id="fileNames" placeholder="例如: file1.xlsx,file2.xlsx">
            <div id="fileValidation" class="text-danger mt-1"></div>
        </div>
    
        <div class="mb-3">
            <label class="form-label">列名设置（用逗号分隔）：</label>
            <div class="input-group">
                <input type="text" class="form-control" id="columnNames" placeholder="例如: Id,randomtype,fixed" 
                       onchange="updateSearchColumnOptions(this.value)">
            </div>
        </div>
        
        <div class="mb-3">
            <label class="form-label">查找目标列：</label>
            <select class="form-select" id="searchColumn">
                <!-- 选项将由 JavaScript 动态生成 -->
            </select>
        </div>
    
        <div class="mb-3">
            <div class="d-flex gap-2">
                <button class="btn btn-primary" onclick="startSearch()">开始搜索</button>
                <button class="btn btn-success" onclick="downloadResults()" style="display: none;">下载结果</button>
            </div>
        </div>
    
        <!-- <div class="progress mb-3" style="display: none;">
            <div class="progress-bar" role="progressbar" style="width: 0%"></div>
        </div> -->
    
        <div class="mb-3">
            <h4>搜索结果：</h4>
            <div id="searchResults"></div>
        </div>
    </div>
</body>
</html> 